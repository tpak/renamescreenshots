#!/bin/bash
# Pre-commit hook to run SwiftLint on staged Swift files

# Check if swiftlint is installed
if ! command -v swiftlint &> /dev/null; then
    echo "‚ö†Ô∏è  SwiftLint not installed. Skipping lint check."
    echo "   Install with: brew install swiftlint"
    exit 0
fi

# Get staged Swift files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.swift$')

if [ -z "$STAGED_FILES" ]; then
    exit 0
fi

echo "üîç Running SwiftLint on staged files..."

# Run swiftlint
swiftlint lint --quiet --strict $STAGED_FILES

RESULT=$?

if [ $RESULT -ne 0 ]; then
    echo ""
    echo "‚ùå SwiftLint found issues. Fix them before committing."
    echo "   Run 'swiftlint' to see all issues."
    exit 1
fi

echo "‚úÖ SwiftLint passed"
exit 0
